import{_ as v,c as d,a as e,f as C,w as i,v as r,n,j as h,k as b,l as S,h as p,m as w,t as u,p as M,g as f,i as m,e as a}from"./index-S0QH5-0V.js";const q={name:"NewLogin",data(){return{currentStep:0,loginMethod:"",loginForm:{username:"",password:"",email:"",qq:"",verificationCode:"",rememberMe:!1},showPassword:!1,isLoggingIn:!1,animationClass:"",countdown:0,timer:null}},methods:{togglePasswordVisibility(){this.showPassword=!this.showPassword},isCurrentStepValid(){if(this.currentStep===2){if(this.loginMethod==="account")return this.loginForm.username;if(this.loginMethod==="email")return this.loginForm.email;if(this.loginMethod==="qq")return this.loginForm.qq}else if(this.currentStep===3&&this.loginMethod==="account")return this.loginForm.password;return!0},getDisplayName(){return this.loginMethod==="account"?this.loginForm.username:this.loginMethod==="email"?this.loginForm.email:this.loginMethod==="qq"?this.loginForm.qq:""},nextStep(){if((this.currentStep===2||this.currentStep===3&&this.loginMethod==="account")&&!this.isCurrentStepValid()){this.showMessage("请填写完整信息");return}if(this.currentStep===2&&this.loginMethod!=="account"&&this.sendVerificationCode(),(this.currentStep===3&&this.loginMethod!=="account"||this.currentStep===4&&this.loginMethod==="account")&&console.log("验证验证码:",this.loginForm.verificationCode),this.currentStep===3&&this.loginMethod==="account"){this.handleLogin();return}if(this.currentStep===3&&this.loginMethod!=="account"){this.handleLogin();return}if(this.loginMethod==="account"&&this.currentStep===2){this.animationClass="slide-out",setTimeout(()=>{this.currentStep=3,this.animationClass="slide-in",setTimeout(()=>{this.animationClass=""},300)},300);return}this.currentStep<5&&(this.animationClass="slide-out",setTimeout(()=>{this.currentStep++,this.animationClass="slide-in",setTimeout(()=>{this.animationClass=""},300)},300))},prevStep(){this.currentStep>0&&(this.animationClass="slide-out-back",setTimeout(()=>{this.currentStep--,this.animationClass="slide-in-back",setTimeout(()=>{this.animationClass=""},300)},300))},async handleLogin(){this.isLoggingIn=!0;try{if(this.loginMethod==="account")(await window.$Api.login(this.loginForm.username,this.loginForm.password)).status===200&&(this.animationClass="slide-out",setTimeout(()=>{this.currentStep=5,this.animationClass="slide-in",setTimeout(()=>{this.animationClass=""},300)},300));else{this.showMessage("此登录方式暂未开放");return}}catch(t){let o="登录失败";t.reason&&(o=t.reason),this.showMessage(o)}finally{this.isLoggingIn=!1}},sendVerificationCode(){this.countdown>0||(this.loginMethod==="email"?console.log("发送验证码到邮箱:",this.loginForm.email):this.loginMethod==="qq"?console.log("发送验证码到QQ邮箱:",this.loginForm.qq+"@qq.com"):this.loginMethod==="account"&&console.log("发送验证码到账号绑定邮箱"),this.countdown=60,this.timer=setInterval(()=>{this.countdown--,this.countdown<=0&&clearInterval(this.timer)},1e3),this.showMessage("验证码已发送"))},onVerificationCodeInput(t){this.loginForm.verificationCode=t.target.value.replace(/\D/g,"")},showMessage(t,o="error"){const l=document.createElement("div");l.innerText=t,l.style.cssText=`
        position: fixed;
        top: -60px;
        left: 50%;
        transform: translateX(-50%);
        background: #fff;
        color: #333;
        padding: 16px 24px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 1000;
        transition: top 0.3s ease, opacity 0.3s ease;
        opacity: 0;
        min-width: 250px;
        text-align: center;
        font-weight: 500;
        border-left: 4px solid ${o==="success"?"#67c23a":"#f56565"};
      `,document.body.appendChild(l),setTimeout(()=>{l.style.top="20px",l.style.opacity="1"},10),setTimeout(()=>{l.style.top="-60px",l.style.opacity="0",setTimeout(()=>{l.parentNode&&document.body.removeChild(l)},300)},3e3)}},beforeDestroy(){this.timer&&clearInterval(this.timer)}},y={class:"login-container"},k={class:"login-card"},F={class:"progress-bar"},V={class:"form-container"},T={class:"login-method"},Q={class:"button-group"},I={class:"login-methods"},c={class:"button-group"},$=["disabled"],N={class:"input-group"},L={class:"button-group"},P=["disabled"],D={class:"input-group"},U={class:"password-input"},z=["type"],B={class:"remember-me-option"},E={class:"remember-me"},j={class:"button-group"},A=["disabled"],X={class:"input-group"},G={class:"button-group"},H=["disabled"],J={class:"input-group"},K={class:"button-group"},O=["disabled"],R={key:0},W={key:1},Y={key:2},Z={class:"input-group"},x={class:"verification-actions"},_={class:"verification-hint"},tt={key:0},ot={key:1},et={key:2},st=["disabled"],it={class:"button-group"},nt={class:"success-message"},lt={class:"button-group"};function rt(t,o,l,dt,at,ut){const g=S("router-link");return a(),d("div",y,[e("div",k,[e("div",F,[e("div",{class:"progress-fill",style:C({width:(t.currentStep+1)*(100/6)+"%"})},null,4)]),e("div",V,[i(e("div",{class:n(["form-step",t.animationClass])},[o[27]||(o[27]=e("h2",null,"欢迎回到幽柠之域",-1)),o[28]||(o[28]=e("p",{class:"subtitle"},"请点击下一步按钮以继续",-1)),e("div",T,[h(g,{to:"/register",class:"register-link"},{default:b(()=>o[25]||(o[25]=[m("没有账户？立即注册！",-1)])),_:1,__:[25]})]),e("div",Q,[h(g,{to:"/",class:"btn btn-prev"},{default:b(()=>o[26]||(o[26]=[m("回到首页",-1)])),_:1,__:[26]}),e("button",{class:"btn btn-next",onClick:o[0]||(o[0]=(...s)=>t.nextStep&&t.nextStep(...s))},"下一步")])],2),[[r,t.currentStep===0]]),i(e("div",{class:n(["form-step",t.animationClass])},[o[29]||(o[29]=e("h2",null,"选择登录方式",-1)),e("div",I,[e("button",{class:n(["method-btn",{active:t.loginMethod==="account"}]),onClick:o[1]||(o[1]=s=>t.loginMethod="account")}," 账号密码 ",2),e("button",{class:n(["method-btn",{active:t.loginMethod==="email"}]),onClick:o[2]||(o[2]=s=>t.loginMethod="email"),disabled:""}," 邮箱验证(暂未开放) ",2),e("button",{class:n(["method-btn",{active:t.loginMethod==="qq"}]),onClick:o[3]||(o[3]=s=>t.loginMethod="qq"),disabled:""}," QQ验证(暂未开放) ",2)]),e("div",c,[e("button",{class:"btn btn-prev",onClick:o[4]||(o[4]=(...s)=>t.prevStep&&t.prevStep(...s))},"上一步"),e("button",{class:"btn btn-next",onClick:o[5]||(o[5]=(...s)=>t.nextStep&&t.nextStep(...s)),disabled:!t.loginMethod}," 下一步 ",8,$)])],2),[[r,t.currentStep===1]]),i(e("div",{class:n(["form-step",t.animationClass])},[o[31]||(o[31]=e("h2",null,"账号密码登录",-1)),e("div",N,[o[30]||(o[30]=e("label",{for:"username"},"账号 *",-1)),i(e("input",{id:"username","onUpdate:modelValue":o[6]||(o[6]=s=>t.loginForm.username=s),type:"text",placeholder:"请输入账号",required:""},null,512),[[p,t.loginForm.username]])]),e("div",L,[e("button",{class:"btn btn-prev",onClick:o[7]||(o[7]=(...s)=>t.prevStep&&t.prevStep(...s))},"上一步"),e("button",{class:"btn btn-next",onClick:o[8]||(o[8]=(...s)=>t.nextStep&&t.nextStep(...s)),disabled:!t.loginForm.username}," 下一步 ",8,P)])],2),[[r,t.currentStep===2&&t.loginMethod==="account"]]),i(e("div",{class:n(["form-step",t.animationClass])},[o[34]||(o[34]=e("h2",null,"账号密码登录",-1)),e("div",D,[o[32]||(o[32]=e("label",{for:"password"},"密码 *",-1)),e("div",U,[i(e("input",{id:"password","onUpdate:modelValue":o[9]||(o[9]=s=>t.loginForm.password=s),type:t.showPassword?"text":"password",placeholder:"请输入密码",required:""},null,8,z),[[w,t.loginForm.password]]),e("button",{type:"button",class:"toggle-password",onClick:o[10]||(o[10]=(...s)=>t.togglePasswordVisibility&&t.togglePasswordVisibility(...s))},u(t.showPassword?"🙈":"👁️"),1)])]),e("div",B,[e("label",E,[i(e("input",{type:"checkbox","onUpdate:modelValue":o[11]||(o[11]=s=>t.loginForm.rememberMe=s)},null,512),[[M,t.loginForm.rememberMe]]),o[33]||(o[33]=e("span",null,"记住我",-1))])]),e("div",j,[e("button",{class:"btn btn-prev",onClick:o[12]||(o[12]=(...s)=>t.prevStep&&t.prevStep(...s))},"上一步"),e("button",{class:"btn btn-next",onClick:o[13]||(o[13]=(...s)=>t.nextStep&&t.nextStep(...s)),disabled:!t.loginForm.password}," 登录 ",8,A)])],2),[[r,t.currentStep===3&&t.loginMethod==="account"]]),i(e("div",{class:n(["form-step",t.animationClass])},[o[36]||(o[36]=e("h2",null,"邮箱登录",-1)),e("div",X,[o[35]||(o[35]=e("label",{for:"email"},"邮箱 *",-1)),i(e("input",{id:"email","onUpdate:modelValue":o[14]||(o[14]=s=>t.loginForm.email=s),type:"email",placeholder:"请输入邮箱",required:""},null,512),[[p,t.loginForm.email]])]),e("div",G,[e("button",{class:"btn btn-prev",onClick:o[15]||(o[15]=(...s)=>t.prevStep&&t.prevStep(...s))},"上一步"),e("button",{class:"btn btn-next",onClick:o[16]||(o[16]=(...s)=>t.nextStep&&t.nextStep(...s)),disabled:!t.loginForm.email}," 下一步 ",8,H)])],2),[[r,t.currentStep===2&&t.loginMethod==="email"]]),i(e("div",{class:n(["form-step",t.animationClass])},[o[38]||(o[38]=e("h2",null,"QQ登录",-1)),e("div",J,[o[37]||(o[37]=e("label",{for:"qq"},"QQ号 *",-1)),i(e("input",{id:"qq","onUpdate:modelValue":o[17]||(o[17]=s=>t.loginForm.qq=s),type:"text",placeholder:"请输入QQ号",required:""},null,512),[[p,t.loginForm.qq]])]),e("div",K,[e("button",{class:"btn btn-prev",onClick:o[18]||(o[18]=(...s)=>t.prevStep&&t.prevStep(...s))},"上一步"),e("button",{class:"btn btn-next",onClick:o[19]||(o[19]=(...s)=>t.nextStep&&t.nextStep(...s)),disabled:!t.loginForm.qq}," 下一步 ",8,O)])],2),[[r,t.currentStep===2&&t.loginMethod==="qq"]]),i(e("div",{class:n(["form-step",t.animationClass]),ref:"verificationStep"},[t.loginMethod==="email"?(a(),d("h2",R,"邮箱验证")):t.loginMethod==="qq"?(a(),d("h2",W,"QQ验证")):t.loginMethod==="account"?(a(),d("h2",Y,"账号验证")):f("",!0),e("div",Z,[o[40]||(o[40]=e("label",{for:"verificationCode"},"验证码 *",-1)),i(e("input",{id:"verificationCode","onUpdate:modelValue":o[20]||(o[20]=s=>t.loginForm.verificationCode=s),type:"text",placeholder:"请输入验证码",required:"",onInput:o[21]||(o[21]=(...s)=>t.onVerificationCodeInput&&t.onVerificationCodeInput(...s))},null,544),[[p,t.loginForm.verificationCode]]),e("div",x,[e("p",_,[o[39]||(o[39]=m(" 验证码已发送至 ",-1)),t.loginMethod==="email"?(a(),d("span",tt,u(t.loginForm.email),1)):t.loginMethod==="qq"?(a(),d("span",ot,u(t.loginForm.qq)+"@qq.com",1)):t.loginMethod==="account"?(a(),d("span",et,"您的注册邮箱")):f("",!0)]),e("button",{class:"btn-resend",onClick:o[22]||(o[22]=(...s)=>t.sendVerificationCode&&t.sendVerificationCode(...s)),disabled:t.countdown>0},u(t.countdown>0?`重新发送(${t.countdown}s)`:"重新发送"),9,st)])]),e("div",it,[e("button",{class:"btn btn-prev",onClick:o[23]||(o[23]=(...s)=>t.prevStep&&t.prevStep(...s))},"上一步"),e("button",{class:"btn btn-next",onClick:o[24]||(o[24]=(...s)=>t.nextStep&&t.nextStep(...s))}," 下一步 ")])],2),[[r,t.currentStep===3&&t.loginMethod!=="account"||t.currentStep===4&&t.loginMethod==="account"]]),i(e("div",{class:n(["form-step",t.animationClass])},[o[42]||(o[42]=e("h2",null,"登录成功",-1)),e("div",nt,[e("p",null,"欢迎回来 "+u(t.getDisplayName()),1)]),e("div",lt,[h(g,{to:"/",class:"btn btn-submit"},{default:b(()=>o[41]||(o[41]=[m("回到首页",-1)])),_:1,__:[41]})])],2),[[r,t.currentStep===5]])])])])}const mt=v(q,[["render",rt],["__scopeId","data-v-5c75df1d"]]);export{mt as default};
