import{_ as m,c as u,a as i,f as h,w as n,g as f,v as a,n as l,h as d,t as r,i as b,e as p}from"./index-CyZgMJgJ.js";const v={data(){return{currentStep:0,formData:{account:"",password:"",mail:"",qq:"",verificationCode:"",qqVerificationCode:""},animationClass:"",countdown:0,qqCountdown:0,timer:null,qqTimer:null,showPassword:!1,isLoading:!1}},computed:{isFormValid(){return this.formData.account&&this.formData.password&&this.formData.mail},showQqVerification(){return this.formData.qq&&this.formData.qq.trim()!==""}},methods:{validateEmail(s){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)},async sendVerificationCode(){if(!(this.countdown>0)){if(!this.validateEmail(this.formData.mail)){this.showMessage("邮箱格式不正确");return}this.isLoading=!0;try{(await window.$Api.sendCode(this.formData.mail)).status===200&&(this.countdown=60,this.timer=setInterval(()=>{this.countdown--,this.countdown<=0&&clearInterval(this.timer)},1e3),this.showMessage("验证码已发送，请查收邮箱"))}catch(s){console.error("发送验证码失败:",s),this.showMessage(s.reason||"发送验证码失败")}finally{this.isLoading=!1}}},async sendQqVerificationCode(){if(this.qqCountdown>0)return;const s=this.formData.qq+"@qq.com";this.isLoading=!0;try{(await window.$Api.sendCode(s)).status===200&&(this.qqCountdown=60,this.qqTimer=setInterval(()=>{this.qqCountdown--,this.qqCountdown<=0&&clearInterval(this.qqTimer)},1e3),this.showMessage("验证码已发送至QQ邮箱，请查收"))}catch(t){console.error("发送QQ验证码失败:",t),this.showMessage(t.reason||"发送QQ验证码失败")}finally{this.isLoading=!1}},showMessage(s){const t=document.createElement("div");t.innerText=s,t.style.cssText=`
        position: fixed;
        top: -60px;
        left: 50%;
        transform: translateX(-50%);
        background: #fff;
        color: #333;
        padding: 16px 24px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 1000;
        transition: top 0.3s ease, opacity 0.3s ease;
        opacity: 0;
        min-width: 250px;
        text-align: center;
        font-weight: 500;
        border-left: 4px solid #409eff;
      `,document.body.appendChild(t),setTimeout(()=>{t.style.top="20px",t.style.opacity="1"},10),setTimeout(()=>{t.style.top="-60px",t.style.opacity="0",setTimeout(()=>{t.parentNode&&document.body.removeChild(t)},300)},3e3)},nextStep(){if(this.currentStep===2){if(!this.validateEmail(this.formData.mail)){this.showMessage("邮箱格式不正确");return}this.sendVerificationCode()}if(this.currentStep===4&&this.showQqVerification){this.currentStep=5;return}if(this.currentStep===5){this.currentStep=6;return}if(this.currentStep===6){this.handleSubmit();return}this.currentStep<7&&(this.animationClass="slide-out",setTimeout(()=>{this.currentStep++,this.currentStep===5&&!this.showQqVerification&&(this.currentStep=6),this.animationClass="slide-in",setTimeout(()=>{this.animationClass=""},300)},300))},prevStep(){if(this.currentStep===7){this.currentStep=6;return}if(this.currentStep===6&&this.showQqVerification){this.currentStep=5;return}if(this.currentStep===6&&!this.showQqVerification){this.currentStep=4;return}if(this.currentStep===5){this.currentStep=4;return}this.currentStep>0?(this.animationClass="slide-out-back",setTimeout(()=>{this.currentStep--,this.animationClass="slide-in-back",setTimeout(()=>{this.animationClass=""},300)},300)):this.showMessage("没有上一个页面啦！")},async handleSubmit(){this.isLoading=!0;try{(await window.$Api.register(this.formData.account,this.formData.password,this.formData.verificationCode)).status===200&&(this.showMessage("注册成功！"),this.currentStep=7)}catch(s){console.error("注册失败:",s),s.status===400?this.showMessage(`注册失败: ${s.reason}`):this.showMessage(s.reason||"注册失败")}finally{this.isLoading=!1}},onVerificationCodeInput(s){this.formData.verificationCode=s.target.value.replace(/\D/g,"")},onQqVerificationCodeInput(s){this.formData.qqVerificationCode=s.target.value.replace(/\D/g,"")},togglePasswordVisibility(){this.showPassword=!this.showPassword},showQqDisabledMessage(){this.showMessage("存在未知问题，该功能已禁用，请直接下一步")}},beforeDestroy(){this.timer&&clearInterval(this.timer),this.qqTimer&&clearInterval(this.qqTimer)}},q={mixins:[v],methods:{prevStep(){if(this.currentStep===0){this.$router.push("/");return}if(this.currentStep===7){this.currentStep=6;return}if(this.currentStep===6&&this.showQqVerification){this.currentStep=5;return}if(this.currentStep===6&&!this.showQqVerification){this.currentStep=4;return}if(this.currentStep===5){this.currentStep=4;return}this.currentStep>0?(this.animationClass="slide-out-back",setTimeout(()=>{this.currentStep--,this.animationClass="slide-in-back",setTimeout(()=>{this.animationClass=""},300)},300)):this.showMessage("没有上一个页面啦！")}}},w={class:"register-container"},S={class:"progress-bar"},C={class:"form-container"},g={class:"input-group"},D={class:"button-group"},V=["disabled"],y={class:"input-group"},c={key:0,class:"password-hint"},Q={class:"button-group"},k=["disabled"],T={class:"input-group"},M={class:"button-group"},I=["disabled"],L={class:"input-group"},P={class:"verification-actions"},E=["disabled"],U={class:"button-group"},N={class:"input-group"},z={class:"button-group"},A={class:"input-group"},B={class:"verification-actions"},F={class:"verification-hint"},R=["disabled"],X={class:"button-group"},j={class:"confirmation-info"},G={class:"info-item"},H={class:"info-value"},J={class:"info-item"},K={class:"info-value"},O={class:"info-item"},W={class:"info-value"},Y={key:0,class:"info-item"},Z={class:"info-value"},$={class:"button-group"},x={class:"completion-message"},_={class:"button-group"};function tt(s,t,st,it,et,o){return p(),u("div",w,[i("div",S,[i("div",{class:"progress-fill",style:h({width:(s.currentStep+1)*(100/8)+"%"})},null,4)]),i("div",C,[n(i("div",{class:l(["form-step",s.animationClass])},[t[28]||(t[28]=i("h2",null,"创建账户",-1)),i("div",g,[t[27]||(t[27]=i("label",{for:"account"},"账号 *",-1)),n(i("input",{type:"text",id:"account","onUpdate:modelValue":t[0]||(t[0]=e=>s.formData.account=e),placeholder:"请输入账号",required:""},null,512),[[d,s.formData.account]])]),i("div",D,[i("button",{class:"btn btn-prev",onClick:t[1]||(t[1]=(...e)=>o.prevStep&&o.prevStep(...e))},"回到首页"),i("button",{class:"btn btn-next",onClick:t[2]||(t[2]=(...e)=>s.nextStep&&s.nextStep(...e)),disabled:!s.formData.account}," 下一步 ",8,V)])],2),[[a,s.currentStep===0]]),n(i("div",{class:l(["form-step",s.animationClass])},[t[30]||(t[30]=i("h2",null,"设置密码",-1)),i("div",y,[t[29]||(t[29]=i("label",{for:"password"},"密码 *",-1)),n(i("input",{type:"password",id:"password","onUpdate:modelValue":t[3]||(t[3]=e=>s.formData.password=e),placeholder:"请输入密码(至少8位)",required:""},null,512),[[d,s.formData.password]]),s.formData.password&&s.formData.password.length<8?(p(),u("p",c," 密码长度至少8位 ")):f("",!0)]),i("div",Q,[i("button",{class:"btn btn-prev",onClick:t[4]||(t[4]=(...e)=>o.prevStep&&o.prevStep(...e))},"上一步"),i("button",{class:"btn btn-next",onClick:t[5]||(t[5]=(...e)=>s.nextStep&&s.nextStep(...e)),disabled:!s.formData.password||s.formData.password.length<8}," 下一步 ",8,k)])],2),[[a,s.currentStep===1]]),n(i("div",{class:l(["form-step",s.animationClass])},[t[32]||(t[32]=i("h2",null,"邮箱地址",-1)),i("div",T,[t[31]||(t[31]=i("label",{for:"mail"},"邮箱 *",-1)),n(i("input",{type:"email",id:"mail","onUpdate:modelValue":t[6]||(t[6]=e=>s.formData.mail=e),placeholder:"请输入邮箱",required:""},null,512),[[d,s.formData.mail]])]),i("div",M,[i("button",{class:"btn btn-prev",onClick:t[7]||(t[7]=(...e)=>o.prevStep&&o.prevStep(...e))},"上一步"),i("button",{class:"btn btn-next",onClick:t[8]||(t[8]=(...e)=>s.nextStep&&s.nextStep(...e)),disabled:!s.formData.mail}," 下一步 ",8,I)])],2),[[a,s.currentStep===2]]),n(i("div",{class:l(["form-step",s.animationClass])},[t[35]||(t[35]=i("h2",null,"邮箱验证",-1)),i("div",L,[t[34]||(t[34]=i("label",{for:"verificationCode"},"验证码 *",-1)),n(i("input",{type:"text",id:"verificationCode","onUpdate:modelValue":t[9]||(t[9]=e=>s.formData.verificationCode=e),placeholder:"请输入验证码",required:"",onInput:t[10]||(t[10]=(...e)=>s.onVerificationCodeInput&&s.onVerificationCodeInput(...e))},null,544),[[d,s.formData.verificationCode]]),i("div",P,[t[33]||(t[33]=i("p",{class:"verification-hint"},"验证码已发送至您的邮箱，请查收",-1)),i("button",{class:"btn-resend",onClick:t[11]||(t[11]=(...e)=>s.sendVerificationCode&&s.sendVerificationCode(...e)),disabled:s.countdown>0},r(s.countdown>0?`重新发送(${s.countdown}s)`:"重新发送"),9,E)])]),i("div",U,[i("button",{class:"btn btn-prev",onClick:t[12]||(t[12]=(...e)=>o.prevStep&&o.prevStep(...e))},"上一步"),i("button",{class:"btn btn-next",onClick:t[13]||(t[13]=(...e)=>s.nextStep&&s.nextStep(...e))}," 下一步 ")])],2),[[a,s.currentStep===3]]),n(i("div",{class:l(["form-step",s.animationClass])},[t[37]||(t[37]=i("h2",null,"可选信息",-1)),i("div",N,[t[36]||(t[36]=i("label",{for:"qq"},"QQ (可选)",-1)),n(i("input",{type:"text",id:"qq","onUpdate:modelValue":t[14]||(t[14]=e=>s.formData.qq=e),placeholder:"请输入QQ号",disabled:"",onFocus:t[15]||(t[15]=(...e)=>s.showQqDisabledMessage&&s.showQqDisabledMessage(...e))},null,544),[[d,s.formData.qq]])]),i("div",z,[i("button",{class:"btn btn-prev",onClick:t[16]||(t[16]=(...e)=>o.prevStep&&o.prevStep(...e))},"上一步"),i("button",{class:"btn btn-next",onClick:t[17]||(t[17]=(...e)=>s.nextStep&&s.nextStep(...e))}," 下一步 ")])],2),[[a,s.currentStep===4]]),s.showQqVerification?n((p(),u("div",{key:0,class:l(["form-step",s.animationClass])},[t[39]||(t[39]=i("h2",null,"QQ邮箱验证",-1)),i("div",A,[t[38]||(t[38]=i("label",{for:"qqVerificationCode"},"验证码 *",-1)),n(i("input",{type:"text",id:"qqVerificationCode","onUpdate:modelValue":t[18]||(t[18]=e=>s.formData.qqVerificationCode=e),placeholder:"请输入验证码",required:"",onInput:t[19]||(t[19]=(...e)=>s.onQqVerificationCodeInput&&s.onQqVerificationCodeInput(...e))},null,544),[[d,s.formData.qqVerificationCode]]),i("div",B,[i("p",F,"验证码已发送至您的QQ邮箱("+r(s.formData.qq)+"@qq.com)，请查收",1),i("button",{class:"btn-resend",onClick:t[20]||(t[20]=(...e)=>s.sendQqVerificationCode&&s.sendQqVerificationCode(...e)),disabled:s.qqCountdown>0},r(s.qqCountdown>0?`重新发送(${s.qqCountdown}s)`:"重新发送"),9,R)])]),i("div",X,[i("button",{class:"btn btn-prev",onClick:t[21]||(t[21]=(...e)=>o.prevStep&&o.prevStep(...e))},"上一步"),i("button",{class:"btn btn-next",onClick:t[22]||(t[22]=(...e)=>s.nextStep&&s.nextStep(...e))}," 下一步 ")])],2)),[[a,s.currentStep===5]]):f("",!0),n(i("div",{class:l(["form-step",s.animationClass])},[t[44]||(t[44]=i("h2",null,"请再次确认您的信息",-1)),i("div",j,[i("div",G,[t[40]||(t[40]=i("span",{class:"info-label"},"账号:",-1)),i("span",H,r(s.formData.account),1)]),i("div",J,[t[41]||(t[41]=i("span",{class:"info-label"},"密码:",-1)),i("span",K,[b(r(s.showPassword?s.formData.password:"•".repeat(s.formData.password.length||4))+" ",1),i("button",{onClick:t[23]||(t[23]=(...e)=>s.togglePasswordVisibility&&s.togglePasswordVisibility(...e)),class:"toggle-password-btn"},r(s.showPassword?"隐藏":"显示"),1)])]),i("div",O,[t[42]||(t[42]=i("span",{class:"info-label"},"邮箱:",-1)),i("span",W,r(s.formData.mail),1)]),s.formData.qq?(p(),u("div",Y,[t[43]||(t[43]=i("span",{class:"info-label"},"QQ:",-1)),i("span",Z,r(s.formData.qq),1)])):f("",!0)]),i("div",$,[i("button",{class:"btn btn-prev",onClick:t[24]||(t[24]=(...e)=>o.prevStep&&o.prevStep(...e))},"上一步"),i("button",{class:"btn btn-submit",onClick:t[25]||(t[25]=(...e)=>s.nextStep&&s.nextStep(...e))}," 确认并提交 ")])],2),[[a,s.currentStep===6]]),n(i("div",{class:l(["form-step",s.animationClass])},[t[46]||(t[46]=i("h2",null,"注册完成",-1)),i("div",x,[t[45]||(t[45]=i("p",null,"账号注册成功！祝您游戏愉快",-1)),i("p",null,"账号: "+r(s.formData.account),1)]),i("div",_,[i("button",{class:"btn btn-submit",onClick:t[26]||(t[26]=(...e)=>s.handleSubmit&&s.handleSubmit(...e))}," 完成注册 ")])],2),[[a,s.currentStep===7]])])])}const nt=m(q,[["render",tt],["__scopeId","data-v-3c2f8c36"]]);export{nt as default};
